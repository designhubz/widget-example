{"version":3,"file":"Designhubz.es5.js","sources":["../src/packages/data/Data.ts","../src/packages/data/index.ts","../src/packages/data-source/MockData.ts","../src/packages/lib/_Dev.ts","../src/packages/lib/_Data.ts","../src/packages/lib/products/_Product.ts","../src/packages/utils/Browser.ts","../src/packages/utils/Signals.ts","../src/packages/utils/index.ts","../src/packages/lib/widgets/Snapshot.ts","../src/packages/lib/widgets/Messaging.ts","../src/packages/lib/widgets/_Widget.ts","../src/packages/lib/widgets/_3DWidget.ts","../src/packages/lib/products/_3DProduct.ts","../src/packages/lib/widgets/_EyewearWidget.ts","../src/packages/lib/products/_EyewearProduct.ts","../src/packages/lib/products/Factory.ts","../src/packages/lib/_Config.ts","../src/packages/lib/_API.ts","../src/packages/lib/internal/_EditorWidget.ts","../src/packages/lib/internal/index.ts","../src/packages/lib/index.ts"],"sourcesContent":["import { IProduct, IDigitization, IClientConfig, Input } from './Storage';\r\nimport { IScene, ISkin } from './Internal';\r\n\r\nclass CustomError\r\n{\r\n\tpublic name?: string;\r\n\tpublic stack?: string;\r\n\tpublic message?: string;\r\n\r\n\tconstructor(error?: string | Error) \r\n\t{\r\n\t\tlet errorObject: Error;\r\n\t\tif(error === undefined || typeof error === 'string') errorObject = new Error(error);\r\n\t\telse errorObject = error;\r\n\t\tObject.assign(this, errorObject);\r\n\t}\r\n}\r\n\r\nexport namespace Errors\r\n{\r\n    export class NotFoundError extends CustomError\r\n    {\r\n        constructor()\r\n        {\r\n            super('NotFoundError');\r\n        }\r\n    }\r\n\r\n    export class AuthenticationError extends CustomError\r\n    {\r\n        constructor()\r\n        {\r\n            super('AuthenticationError');\r\n        }\r\n    }\r\n\r\n    export type ProductData = NotFoundError | AuthenticationError;\r\n    export type Session = NotFoundError | AuthenticationError;\r\n    export type Scene = NotFoundError | AuthenticationError;\r\n    export type Skin = NotFoundError | AuthenticationError;\r\n    export type DigitizationData = NotFoundError;\r\n}\r\n\r\nexport interface IWidgetData\r\n{\r\n    FetchClientConfig(): Promise<IClientConfig>;\r\n    FetchProduct(workspaceId: string, referenceId: string, collectVariationDetails: boolean): Promise<IProduct>;\r\n    \r\n    /** @returns sessionId */\r\n    CreateSession(workspaceId: string, referenceId: string, userId: string): Promise<string>;\r\n    UpdateSession(sessionId: string, data: Input.ISessionData): Promise<void>;\r\n}\r\n\r\nexport interface IViewerData extends IWidgetData\r\n{\r\n    FetchScene(workspaceId: string, referenceId: string): Promise<IScene>;\r\n    \r\n    FetchSkin(workspaceId: string): Promise<ISkin>;\r\n}\r\n\r\nexport interface IEditorData extends IViewerData\r\n{\r\n    readonly apps: {\r\n        viewer: string;\r\n        editor: string;\r\n        eyewear: string;\r\n    };\r\n\r\n    CreateScene(workspaceId: string, referenceId: string, name: string, sceneData?: Input.TJSON, files?: Input.IUploadAsset[]): Promise<IScene>;\r\n    UpdateScene(workspaceId: string, referenceId: string, update: {\r\n        name?: string, // Not implemented server side\r\n        sceneData?: Input.TJSON\r\n    }): Promise<IScene>;\r\n    DeleteScene(workspaceId: string, referenceId: string): Promise<void>;\r\n\r\n    UploadSceneAssets(workspaceId: string, referenceId: string, files: Input.IUploadAsset[]): Promise<IScene>;\r\n    DeleteSceneAssets(workspaceId: string, referenceId: string, names: string[]): Promise<IScene>;\r\n\r\n    CreateSkin(workspaceId: string, skinData: Input.TJSON, files: Input.IUploadAsset[]): Promise<ISkin>;\r\n    DeleteSkin(workspaceId: string): Promise<void>;\r\n\r\n    FetchDigitization(workspaceId: string, modelCode: string): Promise<IDigitization>;\r\n}\r\n","import { IWidgetData, IViewerData, IEditorData } from './Data';\r\nexport * from './Data';\r\nimport * as _Storage from './Storage';\r\nexport import Storage = _Storage;\r\n\r\nimport * as _Internal from './Internal';\r\nexport import Internal = _Internal;\r\n\r\nexport let widget: IWidgetData;\r\nexport let viewer: IViewerData;\r\nexport let editor: IEditorData;\r\n\r\nexport function SetWidgetSource(value: IWidgetData)\r\n{\r\n    widget = value;\r\n}\r\nexport function SetViewerSource(value: IViewerData)\r\n{\r\n    viewer = value;\r\n    SetWidgetSource(value);\r\n}\r\nexport function SetEditorSource(value: IEditorData)\r\n{\r\n    editor = value;\r\n    SetViewerSource(value);\r\n}\r\n","import { IWidgetData, IViewerData, IEditorData, Storage, Errors } from '../data';\r\n\r\nconst searchParams = (new URL(window.location.href)).searchParams;\r\nconst local = Boolean(searchParams.get('local'));\r\nconst s3 = 'https://designhubz-viewer-data.s3-eu-west-1.amazonaws.com/';\r\nconst rootUrl = local ? './storage.ignore/' : s3;\r\n\r\nconst localFlag = local ? '?local=1' : '';\r\nconst apps = {\r\n    viewer: (local ? local + ':2020/example/viewer.html' : 'https://dg0iszzfyf3bz.cloudfront.net/') + localFlag,\r\n    editor: (local ? local + ':2020/example/editor.html' : s3 + 'apps/viewer/editor.html') + localFlag,\r\n    eyewear: (local ? local + ':3000/' : s3 + 'apps/eyewear/index.html') + localFlag\r\n};\r\n\r\nconst blobToBuffer = (blob: Blob) => new Response(blob).arrayBuffer();\r\n\r\nconst fetchJSON = async (url: string) => {\r\n    const response = await fetch(url, { method: 'GET' });\r\n    return response.ok ? response.json() : undefined;\r\n};\r\n// #endregion\r\n\r\n// https://designhubz-viewer-data.s3-eu-west-1.amazonaws.com/user/workspace/eyewear/glass1/scene.json\r\nconst folder = {\r\n    w: (workspaceKey: string) => `${rootUrl}user/workspace/${workspaceKey}/`,\r\n    s: (workspaceKey: string, productKey: string) => `${folder.w(workspaceKey)}scene/${productKey}/`,\r\n    f: (publicFolderUrl: string) => publicFolderUrl.slice(rootUrl.length),\r\n    p: (workspaceKey: string) => `${rootUrl}user/workspace/${workspaceKey}/productData/`,\r\n    d: (workspaceKey: string) => `${rootUrl}user/workspace/${workspaceKey}/digitization/`,\r\n    a: () => `${rootUrl}user/sessions/`\r\n};\r\n\r\n// #region mock server interface (./publish/example/remote/server.js)\r\nconst serverUrl = 'http://127.0.0.1:8082/';\r\nasync function deleteAsync(path: string): Promise<void>\r\n{\r\n    let url = `${serverUrl}?path=${escape(path)}`;\r\n    await fetch(url, { method: 'DELETE' });\r\n}\r\n\r\nasync function storeAsync(path: string, asset: ArrayBuffer | string): Promise<void>\r\n{\r\n    let url = `${serverUrl}?path=${escape(path)}`;\r\n    await fetch(url, {\r\n        method: 'POST', \r\n        body: asset\r\n    });\r\n}\r\n// #endregion\r\n\r\nclass WidgetData implements IWidgetData\r\n{\r\n    async FetchClientConfig(): Promise<Storage.IClientConfig>\r\n    {\r\n        return {\r\n            workspaces: {\r\n                '3D': 'eyewear',\r\n                'Eyewear': 'eyewear',\r\n                'Makeup': 'makeup'\r\n            }\r\n        };\r\n    }\r\n\r\n    async FetchProduct(workspaceId: string, referenceId: string, collectVariationDetails = true): Promise<Storage.IProduct>\r\n    {\r\n        const path = folder.p(workspaceId);\r\n        const product: Storage.IProduct = await fetchJSON(path + referenceId + '.json');\r\n        if(product === undefined) throw new Errors.NotFoundError();\r\n        return product;\r\n    }\r\n\r\n    async FetchSession(sessionId: string): Promise<Storage.Input.ISessionData>\r\n    {\r\n        const path = folder.a();\r\n        const session: Storage.Input.ISessionData = await fetchJSON(path + sessionId + '.json');\r\n        if(session === undefined) throw new Errors.NotFoundError();\r\n        return session;\r\n    }\r\n    async CreateSession(workspaceId: string, referenceId: string, userId: string): Promise<string>\r\n    {\r\n        const sessionId = `${workspaceId}-${referenceId}-${userId}-${Date.now()}`;\r\n        return sessionId;\r\n    }\r\n    async UpdateSession(sessionId: string, data: Storage.Input.ISessionData): Promise<void>\r\n    {\r\n        const path = folder.a();\r\n        await storeAsync(path + sessionId + '.json', JSON.stringify(data));\r\n    }\r\n}\r\n\r\ninterface IMockScene extends Omit<Storage.IScene, 'publicFolderUrl'>\r\n{\r\n    _assetsUrls: Storage.IAssetUrl[];\r\n}\r\n\r\ninterface IMockSkin extends Omit<Storage.ISkin, 'publicFolderUrl'>\r\n{\r\n    _assetsUrls: Storage.IAssetUrl[];\r\n}\r\n\r\nconst resolveUrls = (publicFolderUrl: string, assetsUrls: Storage.IAssetUrl[]) => { \r\n    assetsUrls.forEach( v => (v as any).url = `${rootUrl}${publicFolderUrl}${v.name}` );\r\n};\r\n\r\nclass ViewerData extends WidgetData implements IViewerData\r\n{\r\n    async FetchScene(workspaceId: string, referenceId: string): Promise<Storage.IScene>\r\n    {\r\n        const path = folder.s(workspaceId, referenceId);\r\n        const scene: IMockScene = await fetchJSON(path + 'scene.json');\r\n        if(scene === undefined) throw new Errors.NotFoundError();\r\n        scene._assetsUrls = JSON.parse(JSON.stringify(scene.assetsUrls));\r\n        const publicFolderUrl = folder.f(path);\r\n        resolveUrls(publicFolderUrl, scene.assetsUrls);\r\n        return Object.assign({\r\n            publicFolderUrl: publicFolderUrl\r\n        }, scene);\r\n    }\r\n    async FetchSkin(workspaceId: string): Promise<Storage.ISkin>\r\n    {\r\n        const path = folder.w(workspaceId);\r\n        const skin: IMockSkin = await fetchJSON(path + 'skin.json');\r\n        if(skin === undefined) throw new Errors.NotFoundError();\r\n        skin._assetsUrls = JSON.parse(JSON.stringify(skin.assetsUrls));\r\n        const publicFolderUrl = folder.f(path);\r\n        resolveUrls(publicFolderUrl, skin.assetsUrls);\r\n        return Object.assign({\r\n            publicFolderUrl: publicFolderUrl\r\n        }, skin);\r\n    }\r\n}\r\n\r\nexport class MockData extends ViewerData implements IEditorData\r\n{\r\n    public readonly apps = apps;\r\n\r\n    async CreateScene(workspaceId: string, referenceId: string, name: string, sceneData?: Storage.Input.TJSON, files?: Storage.Input.IUploadAsset[]): Promise<Storage.IScene>\r\n    {\r\n        const path = folder.s(workspaceId, referenceId);\r\n\r\n        const assetsUrls: {name: string, url: string}[] = [];\r\n        if(files !== undefined) await Promise.all( files.map( async file => {\r\n            assetsUrls.push({\r\n                name: file.name,\r\n                url: file.name\r\n            });\r\n            return storeAsync(path + file.name, await blobToBuffer(file.content));\r\n        }));\r\n        \r\n        const scene: IMockScene = {\r\n            _assetsUrls: assetsUrls,\r\n            assetsUrls: assetsUrls,\r\n            createdAt: Date.now(),\r\n            isActive: false,\r\n            name: name,\r\n            sceneData: sceneData,\r\n            referenceId: referenceId,\r\n            workspaceId: workspaceId\r\n        };\r\n        await storeAsync(path + 'scene.json', JSON.stringify(scene));\r\n\r\n        return this.FetchScene(workspaceId, referenceId);\r\n    }\r\n    async UpdateScene(workspaceId: string, referenceId: string, update: {\r\n        name?: string;\r\n        sceneData?: Storage.Input.TJSON;\r\n        files?: Storage.Input.IUploadAsset[],\r\n        deleteFiles?: string[]\r\n    }): Promise<Storage.IScene>\r\n    {\r\n        let scene = await this.FetchScene(workspaceId, referenceId);\r\n        if(update.name !== undefined) (scene as any).name = update.name;\r\n        if(update.sceneData !== undefined) (scene as any).sceneData = update.sceneData;\r\n\r\n        const assetsUrls: IMockScene['_assetsUrls'] = (scene as any)._assetsUrls;\r\n        if(update.files !== undefined)\r\n        {\r\n            await Promise.all( update.files.map( async file => {\r\n                assetsUrls.push({\r\n                    name: file.name,\r\n                    url: file.name\r\n                });\r\n                return storeAsync(path + file.name, await blobToBuffer(file.content));\r\n            }));\r\n        }\r\n        if(update.deleteFiles !== undefined)\r\n        {\r\n            await Promise.all( update.deleteFiles.map( filename => {\r\n                const i = assetsUrls.findIndex( v => v.name === filename );\r\n                if(i !== -1) assetsUrls.splice(i, 1);\r\n                return deleteAsync(path + filename);\r\n            }));\r\n        }\r\n        (scene as any).assetsUrls = assetsUrls;\r\n\r\n        const path = folder.s(workspaceId, referenceId);\r\n        await storeAsync(path + 'scene.json', JSON.stringify(scene));\r\n\r\n        return this.FetchScene(workspaceId, referenceId);\r\n    }\r\n    async DeleteScene(workspaceId: string, referenceId: string): Promise<void>\r\n    {\r\n        const scene = await this.FetchScene(workspaceId, referenceId);\r\n        const path = folder.s(workspaceId, referenceId);\r\n        await deleteAsync(path + 'scene.json');\r\n    }\r\n\r\n    async UploadSceneAssets(workspaceId: string, referenceId: string, files: Storage.Input.IUploadAsset[]): Promise<Storage.IScene>\r\n    {\r\n        return this.UpdateScene(workspaceId, referenceId, {files: files});\r\n    }\r\n    async DeleteSceneAssets(workspaceId: string, referenceId: string, names: string[]): Promise<Storage.IScene>\r\n    {\r\n        return this.UpdateScene(workspaceId, referenceId, {deleteFiles: names});\r\n    }\r\n\r\n    async CreateSkin(workspaceId: string, skinData: Storage.Input.TJSON, files: Storage.Input.IUploadAsset[]): Promise<Storage.ISkin>\r\n    {\r\n        const path = folder.w(workspaceId);\r\n\r\n        const assetsUrls: {name: string, url: string}[] = [];\r\n        if(files !== undefined) await Promise.all( files.map( async file => {\r\n            assetsUrls.push({\r\n                name: file.name,\r\n                url: file.name\r\n            });\r\n            return storeAsync(path + file.name, await blobToBuffer(file.content));\r\n        }));\r\n        \r\n        const skin: IMockSkin = {\r\n            _assetsUrls: assetsUrls,\r\n            assetsUrls: assetsUrls,\r\n            createdAt: Date.now(),\r\n            isActive: false,\r\n            skinData: skinData,\r\n            workspaceId: workspaceId\r\n        };\r\n        await storeAsync(path + 'skin.json', JSON.stringify(skin));\r\n\r\n        return this.FetchSkin(workspaceId);\r\n    }\r\n    async DeleteSkin(workspaceId: string): Promise<void>\r\n    {\r\n        const skin = await this.FetchSkin(workspaceId);\r\n        const path = folder.w(workspaceId);\r\n        await deleteAsync(path + 'skin.json');\r\n    }\r\n\r\n    async FetchDigitization(workspaceId: string, modelCode: string): Promise<Storage.IDigitization>\r\n    {\r\n        const path = folder.d(workspaceId);\r\n        const digitization: Storage.IDigitization = await fetchJSON(path + modelCode + '.json');\r\n        if(digitization === undefined) throw new Errors.NotFoundError();\r\n        return digitization;\r\n    }\r\n}\r\n","import { Dev } from '../api';\r\n\r\nconst formatOptions = ['font-weight', 'color', 'background'];\r\n\r\nexport const _dev = new (\r\n    class _Dev implements Dev\r\n    {\r\n        public debug = false;\r\n\r\n        public Log(...args: Array<any>)\r\n        {\r\n            if(this.debug)\r\n            {\r\n                const formatting: string[] = [];\r\n                for(let i = 0; i < args.length - 1; i++)\r\n                {\r\n                    const arg = args[i];\r\n                    const text = args[i + 1];\r\n                    if(typeof arg === 'string' && typeof text === 'string' && arg.slice(0, 2) === '#(')\r\n                    {\r\n                        const optionsArgs = arg.slice(2, arg.length - 1).split(',');\r\n                        let format = formatOptions.map( (o, i) => \r\n                            typeof optionsArgs[i] === 'string' && optionsArgs[i].length > 0\r\n                                ? `${o}:${optionsArgs[i]};`\r\n                            : ''\r\n                        ).join(' ');\r\n                        \r\n                        args.splice(i, 1);\r\n                        args[i] = `%c ${text} `;\r\n                        formatting.push(format);\r\n                    }\r\n                }\r\n                if(formatting.length > 0) console.log(args.map( arg => arg.toString() ).join(''), ...formatting);\r\n                else console.log(...args);\r\n            }\r\n        }\r\n\r\n        public CreateError(name: string, message?: string)\r\n        {\r\n            this.Log(`Created ERROR '${name}': '${message}'`);\r\n            const error = new Error(message);\r\n            error.name = name;\r\n            return error;\r\n        }\r\n    }\r\n);\r\n","\r\nimport { SetEditorSource } from '../data';\r\nimport { MockData } from '../data-source';\r\nimport { _dev } from './_Dev';\r\n\r\nif(!window.location) throw new Error('Expected access to window.location');\r\nif(!('href' in window.location)) throw new Error('Expected href in window.location');\r\n\r\nSetEditorSource(new MockData());\r\n\r\n/** enabled = ?designhubz_debug=bool */\r\nexport const DEV_DEBUG_URL_PARAM = 'designhubz_debug';\r\nconst bool = (p: string | null) => p === '1' || p === 'true';\r\nconst searchParams = (new URL(window.location.href)).searchParams;\r\nif(bool(searchParams.get(DEV_DEBUG_URL_PARAM))) _dev.debug = true;\r\n","import { IProduct, IScoredRecommendation } from '../../api';\r\n\r\nexport abstract class _Product<T> implements IProduct<T>\r\n{\r\n    public readonly is3D = () => false;\r\n    public readonly isEyewear = () => false;\r\n    public readonly isMakeup = () => false;\r\n\r\n    public readonly variations: this[];\r\n\r\n    constructor(\r\n        public readonly workspaceKey: string,\r\n        public readonly productKey: string,\r\n        public readonly properties: T,\r\n        variations: _Product<T>[]\r\n    )\r\n    {\r\n        this.variations = variations as this[];\r\n    }\r\n\r\n    public get thumbnailURL(){ return ''; }\r\n\r\n    public fetchRecommendations(num: number, external?: IScoredRecommendation[]): Promise<IScoredRecommendation[]>\r\n    {\r\n        const recommendations = new Array<IScoredRecommendation>(num);\r\n        recommendations.map( (_, i) => { \r\n            return {\r\n                sku: i.toString(),\r\n                score: i / num\r\n            };\r\n        });\r\n        return new Promise( r => r(recommendations) );\r\n    }\r\n}\r\n","\r\nexport namespace Dom\r\n{\r\n    export function CreateStylesheet(css: string)\r\n    {\r\n        const style = document.createElement('style');\r\n        style.type = 'text/css';\r\n        style.innerHTML = css;\r\n        document.getElementsByTagName('head')[0].appendChild(style);\r\n        return style;\r\n    }\r\n\r\n    export function BuildHTML<T extends HTMLElement>(html: string): T\r\n    {\r\n        const div = document.createElement('div');\r\n        div.innerHTML = html.trim();\r\n        return div.firstChild as T;\r\n    }\r\n}\r\n","type callback<T> = (arg: T) => void;\r\n\r\nexport interface ISignal<T>\r\n{\r\n    Add(callback: callback<T>): void;\r\n    Remove(callback: callback<T>): void;\r\n    Once(callback: callback<T>): void;\r\n}\r\n\r\nexport class Signal<T> implements ISignal<T>\r\n{\r\n    public callbacks: callback<T>[];\r\n\r\n    constructor()\r\n    {\r\n        this.callbacks = [];\r\n    }\r\n\r\n    public Add(callback: callback<T>)\r\n    {\r\n        if(typeof callback !== 'function')\r\n        {\r\n            console.warn('Not a function', callback);\r\n            throw(\"'callback' should be a function.\");\r\n        }\r\n        this.callbacks.push(callback);\r\n    }\r\n\r\n    public Remove(callback: callback<T>)\r\n    {\r\n        const index = this.callbacks.indexOf(callback);\r\n        if(index !== -1) this.callbacks.splice(index, 1);\r\n    }\r\n\r\n    public Dispatch(arg: T)\r\n    {\r\n        for(let i = 0; i < this.callbacks.length; i++) this.callbacks[i](arg);\r\n    }\r\n\r\n    public Once(callback: callback<T>)\r\n    {\r\n        const once = (arg: T) => {\r\n            this.Remove(once);\r\n            callback(arg);\r\n        };\r\n        this.Add(once);\r\n    }\r\n}\r\n\r\n// Example\r\nclass Keyboard\r\n{\r\n    private readonly _onInput = new Signal<string>();\r\n    public get Input(): ISignal<string> { return this._onInput; }\r\n\r\n    public Enter(text: string)\r\n    {\r\n        this._onInput.Dispatch(text);\r\n    }\r\n\r\n    public static Example()\r\n    {\r\n        const keyboard = new Keyboard();\r\n        keyboard.Input.Add(key => console.log(`keyboard.Input -> ${key}`));\r\n        keyboard.Enter('x');\r\n    }\r\n}\r\n","console.log('@designhubz-widget/utils');\r\n\r\nexport * from './Browser';\r\nexport * from './Signals';","import { ISnapshot } from '../../api';\r\n\r\ntype TImageSource = (CanvasImageSource & {width: number, height: number}) | ImageData;\r\nlet _canvas: HTMLCanvasElement;\r\n\r\nfunction DrawToCanvas(source: TImageSource, flip: boolean)\r\n{\r\n    if(_canvas === undefined) _canvas = document.createElement('canvas');\r\n\r\n\t_canvas.width = source.width;\r\n\t_canvas.height = source.height;\r\n\r\n    const context = _canvas.getContext('2d')!;\r\n    context.resetTransform();\r\n    if(flip)\r\n    {\r\n        context.translate(0, _canvas.height);\r\n        context.scale(1, -1);\r\n    }\r\n\r\n    if(source instanceof ImageData) context.putImageData(source, 0, 0);\r\n    else context.drawImage(source, 0, 0, source.width, source.height);\r\n    return _canvas;\r\n}\r\n\r\nexport class Snapshot implements ISnapshot\r\n{\r\n    constructor(public readonly imageData: ImageData)\r\n    {}\r\n\r\n    public getDataURL(type: 'jpeg' | 'png', quality?: number)\r\n    {\r\n        const canvas =  DrawToCanvas(this.imageData, false);\r\n        return canvas.toDataURL(type === 'jpeg' ? 'image/jpeg' : 'image/png', quality)\r\n    }\r\n\r\n    public async getBlobAsync(type: 'jpeg' | 'png', quality?: number)\r\n    {\r\n        const canvas =  DrawToCanvas(this.imageData, false);\r\n        const blob = await new Promise<Blob>( (resolve, reject) => \r\n            canvas.toBlob( blob => {\r\n                if(blob === null) reject('Failed to generate Blob');\r\n                else resolve(blob);\r\n            }, type === 'jpeg' ? 'image/jpeg' : 'image/png', quality)\r\n        );\r\n\r\n        return blob;\r\n    }\r\n}\r\n","\r\nexport const DESIGNHUBZ_API_TYPE = 'designhubz-api';\r\n\r\nexport const enum WidgetEvent {\r\n    Init = 'Init',\r\n    SnapshotRequest = 'SnapshotRequest',\r\n    Save = 'Save',\r\n    Debug = 'Debug'\r\n}\r\n\r\nexport interface IWidgetMessageData\r\n{\r\n    type: string;\r\n    id: string;\r\n    event: WidgetEvent;\r\n    value: any;\r\n}\r\n\r\nexport type TWidgetMessage = { data: IWidgetMessageData };\r\n","import { IWidget, IProduct, Stat, TProgressCallback } from '../../api';\r\nimport { Signal, Dom, ISignal } from '../../utils';\r\nimport { _dev } from '../_Dev';\r\nimport { _Product } from '../products/_Product';\r\nimport { Snapshot } from './Snapshot';\r\nimport * as Messaging from './Messaging';\r\n\r\nexport abstract class _Widget<T, P extends IProduct<T>> implements IWidget<T, P>\r\n{\r\n    public readonly waitForInit = new Promise<this>( resolve => (this as any)._waitForInit = resolve );\r\n\r\n    protected _variation: P;\r\n    protected _iframe: HTMLIFrameElement;\r\n\r\n    private readonly _id = Math.floor(Math.random() * 1000) + '-';\r\n    private _queriesCount = 0;\r\n    private _pending = new Map<string, (arg: any) => void>();\r\n\r\n    constructor(\r\n        defaultVariation: P,\r\n        public readonly domElement: HTMLDivElement\r\n    ){\r\n        onmessage = message => {\r\n            if(message.data?.type === Messaging.DESIGNHUBZ_API_TYPE )\r\n                this.OnWidgetMessage((message as Messaging.TWidgetMessage).data);\r\n        };\r\n\r\n        this._variation = defaultVariation;\r\n\r\n        this._iframe = Dom.BuildHTML<HTMLIFrameElement>(`<iframe\r\n    style=\"width: 1px; min-width: 100%; *width: 100%; height: 1px; min-height: 100%; *height: 100%;\" \r\n    width=\"100%\" height=\"100%\" scrolling=\"no\" frameBorder=\"0\"\r\n</iframe>`);\r\n    }\r\n\r\n    public get variation(){ return this._variation; }\r\n\r\n    public async loadVariation(variation: P, progressHandler?: TProgressCallback)\r\n    {\r\n        if(this._variation.variations.every( v => v.productKey !== variation.productKey ))\r\n            throw new Error(`Product '${variation.productKey}' is not a variation of ${this._variation.variations.map( v => v.productKey ).join(', ')}`);\r\n\r\n        if(progressHandler !== undefined)\r\n        {\r\n            \r\n        }\r\n    }\r\n\r\n    public async takeSnapshotAsync()\r\n    {\r\n        const query = await this.QueryAsync({\r\n            event: Messaging.WidgetEvent.SnapshotRequest,\r\n            value: {\r\n                flip: false\r\n            }\r\n        });\r\n        const imageData = new ImageData(new Uint8ClampedArray(query.value.data.buffer), query.value.width, query.value.height)\r\n        return new Snapshot(imageData);\r\n    }\r\n\r\n    public sendStat(stat: Stat)\r\n    {\r\n        return Promise.resolve();\r\n    }\r\n\r\n    public async disposeAsync()\r\n    {\r\n        if(this._iframe.parentElement !== null) this._iframe.parentElement.removeChild(this._iframe);\r\n    }\r\n\r\n    protected OnWidgetMessage(data: Messaging.IWidgetMessageData)\r\n    {\r\n        let resolver = this._pending.get(data.id);\r\n        if(resolver !== undefined)\r\n        {\r\n            resolver(data);\r\n        }\r\n        else\r\n        {\r\n            switch(data.event)\r\n            {\r\n                case Messaging.WidgetEvent.Init:\r\n                    (this as any)._waitForInit(this);\r\n                break;\r\n\r\n                default:\r\n                    _dev.Log(`No listeners on '${event}'`, data.value);\r\n                break;\r\n            } \r\n        }\r\n    }\r\n\r\n    protected async QueryAsync(message: Messaging.IWidgetMessageData, waitForReply?: boolean): Promise<Messaging.IWidgetMessageData>\r\n    protected async QueryAsync(message: Omit<Messaging.IWidgetMessageData, 'type' | 'id'>, waitForReply?: boolean): Promise<Messaging.IWidgetMessageData>\r\n    protected async QueryAsync(message: Messaging.IWidgetMessageData, waitForReply = true): Promise<Messaging.IWidgetMessageData>\r\n    {\r\n        if(this._iframe.contentWindow === null) throw new Error(`Can't query iframe's contentWindow.`);\r\n\r\n        if(('type' in message && 'id' in message) === false)\r\n        {\r\n            message = Object.assign({\r\n                type: Messaging.DESIGNHUBZ_API_TYPE,\r\n                id: this._id + (this._queriesCount++)\r\n            }, message);\r\n        }\r\n\r\n        const promise = waitForReply\r\n            ? new Promise<Messaging.IWidgetMessageData>( r => this._pending.set(message.id, r) )\r\n        : Promise.resolve(message);\r\n\r\n        this._iframe.contentWindow!.postMessage(message, '*');\r\n        return promise;\r\n    }\r\n\r\n    protected Attach()\r\n    {\r\n        // what kind of dom events do I need to handle?\r\n        this.domElement.appendChild(this._iframe);\r\n    }\r\n}","import { I3DWidget } from '../../api';\r\nimport { editor as Data } from '../../data';\r\nimport { _Widget } from './_Widget';\r\nimport { _Product } from '../products/_Product';\r\nimport { _3DProduct } from '../products/_3DProduct';\r\n\r\n\r\nexport class _3DWidget<T, P extends _3DProduct<T>> extends _Widget<T, P> implements I3DWidget<T>\r\n{\r\n    public _3D = true;\r\n\r\n    constructor(\r\n        defaultVariation: P,\r\n        domElement: HTMLDivElement,\r\n        src?: string\r\n    ){\r\n        super(defaultVariation, domElement);\r\n\r\n        this._iframe.src = src ?? `${Data.apps.viewer}?workspaceId=${defaultVariation.workspaceKey}&referenceId=${defaultVariation.productKey}`;\r\n        this.Attach();\r\n    }\r\n}","import { I3DProduct, TProgressCallback } from '../../api';\r\nimport { _Product } from './_Product';\r\nimport { _3DWidget } from '../widgets/_3DWidget';\r\n\r\nexport class _3DProduct<T> extends _Product<T> implements I3DProduct<T>\r\n{\r\n    public _3D = true;\r\n    public readonly is3D = () => true;\r\n    \r\n    public async create3DWidget(domElement: HTMLDivElement, progressHandler?: TProgressCallback): Promise<_3DWidget<T, this>>\r\n    {\r\n        const widget = new _3DWidget(this, domElement);\r\n        return await widget.waitForInit;\r\n    }\r\n}\r\n","import { IEyewearWidget, TrackingStatus } from '../../api';\r\nimport { ISignal, Signal } from '../../utils';\r\nimport { editor as Data } from '../../data';\r\nimport { _Widget } from './_Widget';\r\nimport { _EyewearProduct } from '../products/_EyewearProduct';\r\n\r\nexport class _EyewearWidget<T, P extends _EyewearProduct<T>> extends _Widget<T, P> implements IEyewearWidget<T>\r\n{\r\n    public _eyewear = true;\r\n    \r\n    public readonly onTrackingStatusChange: ISignal<TrackingStatus> = new Signal();\r\n    \r\n    constructor(\r\n        defaultVariation: P,\r\n        domElement: HTMLDivElement\r\n    ){\r\n        super(defaultVariation, domElement);\r\n\r\n        this._iframe.setAttribute('allow', 'camera;microphone');\r\n        this._iframe.src = `${Data.apps.viewer}?workspaceId=${defaultVariation.workspaceKey}&referenceId=${defaultVariation.productKey}`;\r\n        console.log(this._iframe.src);\r\n        this.Attach();\r\n    }\r\n\r\n    public get fit(){ return true; }\r\n}","import { IEyewearProduct, TProgressCallback } from '../../api';\r\nimport { _3DProduct } from './_3DProduct';\r\nimport { _3DWidget } from '../widgets/_3DWidget';\r\nimport { _EyewearWidget } from '../widgets/_EyewearWidget';\r\n\r\nexport class _EyewearProduct<T> extends _3DProduct<T> implements IEyewearProduct<T>\r\n{\r\n    public _eyewear = true;\r\n    public _3D = true;\r\n    public readonly isEyewear = () => true;\r\n    \r\n    public async create3DWidget(domElement: HTMLDivElement, progressHandler?: TProgressCallback): Promise<_3DWidget<T, this>>\r\n    {\r\n        const widget = new _3DWidget(this, domElement);\r\n        return await widget.waitForInit;\r\n    }\r\n\r\n    public async createEyewearWidget(domElement: HTMLDivElement, progressHandler?: TProgressCallback): Promise<_EyewearWidget<T, this>>\r\n    {\r\n        const widget = new _EyewearWidget(this, domElement);\r\n        return await widget.waitForInit;\r\n    }\r\n\r\n    public async createMultiWidget(domElement: HTMLDivElement, progressHandler?: TProgressCallback): Promise<any>\r\n    {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n}\r\n","import { Internal } from '../../data';\r\nimport { _Product } from './_Product';\r\nimport { _3DProduct } from './_3DProduct';\r\nimport { _EyewearProduct } from './_EyewearProduct';\r\n\r\nconst _productsCache: Record<string, _Product<any>> = {};\r\nexport function ProductFromCache<T>(workspaceKey: string, productKey: string): _Product<T> | undefined\r\n{\r\n    return _productsCache[workspaceKey + productKey];\r\n}\r\n\r\nconst _variationsCache: Record<string, _Product<any>[]> = {};\r\nfunction VariationsFromCache<T>(workspaceKey: string, productKey: string): _Product<T>[] | undefined\r\n{\r\n    return _variationsCache[workspaceKey + productKey];\r\n}\r\n\r\nexport function ProductFromData<T extends Record<string, string>>(data: Internal.IProductData, props?: T)\r\n{\r\n    let product = ProductFromCache<T>(data.workspaceKey, data.productKey);\r\n    if(product !== undefined) return product;\r\n\r\n    let variations = VariationsFromCache<T>(data.workspaceKey, data.productKey);\r\n    if(variations === undefined)\r\n    {\r\n        variations = [];\r\n        data.variations.forEach( variation => {\r\n            const vData = variation as Internal.IProductData;\r\n            _variationsCache[vData.workspaceKey + vData.productKey] = variations!;\r\n        });\r\n    }\r\n\r\n    if(props !== undefined)\r\n    {\r\n        let missingProps: string[] = [];\r\n        for(const key in props)\r\n        {\r\n            const header = props[key];\r\n            if(header in data.properties)\r\n            {\r\n                if(key in data.properties) console.warn(`Custom property accessor '${key}' will override existing property.`);\r\n                Object.defineProperty(data.properties, key, {\r\n                    get: () => data.properties[header]\r\n                });\r\n            }\r\n            else\r\n            {\r\n                missingProps.push(header);\r\n            }\r\n        }\r\n\r\n        if(missingProps.length > 0)\r\n        {\r\n            const plr = missingProps.length > 1;\r\n            console.warn(`Custom propert${plr ? 'ies' : 'y'}: '${missingProps.join(`', '`)}' ${plr ? 'are' : 'is'} missing from '${data.productKey}'`);\r\n        }\r\n    }\r\n\r\n    const productArgs: [string, string, T, _Product<T>[]] = [\r\n        data.workspaceKey,\r\n        data.productKey,\r\n        data.properties,\r\n        variations\r\n    ];\r\n\r\n    switch(data.productType)\r\n    {\r\n        case '3D':\r\n            product = new _3DProduct<T>(...productArgs);\r\n        break;\r\n        case 'Eyewear':\r\n            product = new _EyewearProduct<T>(...productArgs);\r\n        break;\r\n        case 'Makeup':\r\n            throw 'Not implemented';\r\n        default:\r\n            throw 'Not implemented';\r\n    }\r\n\r\n    variations.push(product);\r\n    _productsCache[data.workspaceKey + data.productKey] = product;\r\n    return product;\r\n}\r\n","import { Storage } from '../data';\r\n\r\ninterface IConfig\r\n{\r\n    readonly workspaces: Record<Storage.TProductType, string>;\r\n}\r\n\r\nexport const configAsync: Promise<IConfig> = new Promise( (resolve, reject) => {\r\n    resolve({\r\n        workspaces: {\r\n            '3D': 'eyewear',\r\n            'Eyewear': 'eyewear',\r\n            'Makeup': 'makeup'\r\n        }\r\n    });\r\n});","import { IProduct, IEyewearProduct, IMakeupProduct } from '../api';\r\nimport { widget as Data } from '../data';\r\nimport { _Product } from './products/_Product';\r\nimport { ProductFromCache, ProductFromData } from './products/Factory';\r\nimport { _dev } from './_Dev';\r\nimport { configAsync } from './_Config';\r\n\r\nexport {\r\n    Stat, TrackingStatus,\r\n    IProduct, IEyewearProduct, IMakeupProduct,\r\n    IWidget, I3DWidget, IEyewearWidget, IMakeupWidget, IMultiWidget\r\n} from '../api';\r\n\r\nexport const version: string = '0.0.7';\r\n\r\nexport const dev = _dev;\r\n\r\nexport async function fetchProduct<T extends Record<string, string>>(workspaceKey: string, productKey: string, props?: T): Promise<IProduct<T>>\r\n{\r\n    if(typeof workspaceKey !== 'string' || typeof productKey !== 'string')\r\n        throw new RangeError(`Invalid arguments: fetchProduct(${workspaceKey}: string, ${productKey}: string)`);\r\n    let product = ProductFromCache<T>(workspaceKey, productKey);\r\n    if(product === undefined)\r\n    {\r\n        _dev.Log('#(bold,#f00)', 'fetching product:', '#()', `(${workspaceKey}, ${productKey})`);\r\n        const productData = await Data.FetchProduct(workspaceKey, productKey, true);\r\n        product = ProductFromData<T>({\r\n            workspaceKey: workspaceKey,\r\n            productKey: productKey,\r\n            name: productData.name,\r\n            productType: 'Eyewear',\r\n            properties: Object.assign({}, productData.originalProperties),\r\n            variations: productData.variations.map( v => {\r\n                return {\r\n                    productKey: v.referenceId,\r\n                    name: v.name,\r\n                    properties: Object.assign({}, v.originalProperties)\r\n                };\r\n            })\r\n        }, props);\r\n    }\r\n    else\r\n    {\r\n        _dev.Log('#(bold,#f88)', '(cache) fetching product:', '#()', `(${workspaceKey} | ${productKey})`);\r\n    }\r\n    return product;\r\n}\r\n\r\nexport async function fetchProducts<T extends Record<string, string>>(workspaceKey: string, productKeys: string[], props?: T): Promise<Record<string, IProduct<T> | undefined>>\r\n{\r\n    if(typeof workspaceKey !== 'string' || (productKeys instanceof Array) === false || productKeys.length === 0 || typeof productKeys[0] !== 'string')\r\n        throw new RangeError(`Invalid arguments: fetchProducts(${workspaceKey}: string, ${productKeys.join(', ')}: string[])`);\r\n    \r\n    _dev.Log('#(bold,#000)', 'fetching products:', '#()', `(${workspaceKey}, [${productKeys.join(', ')}])`);\r\n    console.warn('fetchProducts: Not implemented');\r\n    return (void 0)!;\r\n    // const result: Record<string, IProduct<T> | undefined> = {};\r\n    // const stats = {cache: 0, fetch: 0, missing: productKeys.length};\r\n    // const productsToFetch: string[] = [];\r\n    // productKeys.forEach( productKey => {\r\n    //     const product = ProductFromCache<T>(workspaceKey, productKey);\r\n    //     if(product === undefined)\r\n    //     {\r\n    //         productsToFetch.push(productKey);\r\n    //     }\r\n    //     else\r\n    //     {\r\n    //         stats.cache++;\r\n    //         stats.missing--;\r\n    //         result[productKey] = product;\r\n    //     }\r\n    // });\r\n    // if(productsToFetch.length > 0)\r\n    // {\r\n    //     const productsMap = await Data.FetchProducts(workspaceKey, productsToFetch, true);\r\n    //     productsToFetch.forEach( productKey => {\r\n    //         const product = productsMap[productKey];\r\n    //         if(product !== undefined)\r\n    //         {\r\n    //             stats.fetch++;\r\n    //             stats.missing--;\r\n    //             result[productKey] = ProductFromData<T>(product.productData, props);\r\n    //         }\r\n    //     });\r\n    // }\r\n    // _dev.Log(\r\n    //     '#(,#f88)', `${stats.cache} from cache`, ' | ', \r\n    //     stats.fetch > 0 ? '#(bold,#f00)' : '#(bold)', `${stats.fetch} fetched`, ' | ', \r\n    //     stats.missing > 0 ? '#(#fff,#f00)' : '#(bold)', `${stats.missing} missing`);\r\n    // return result;\r\n}\r\n\r\nexport async function fetchEyewearProduct<T extends Record<string, string>>(productKey: string, props?: T): Promise<IEyewearProduct<T>>\r\n{\r\n    if(typeof productKey !== 'string')\r\n        throw new RangeError(`Invalid arguments: fetchEyewearProduct(${productKey}: string)`);\r\n    \r\n    const workspaceKey = (await configAsync).workspaces.Eyewear;\r\n    const product = await fetchProduct(workspaceKey, productKey, props);\r\n    if(product.isEyewear()) return product;\r\n    else throw new Error(`${productKey} is not of 'Eyewear' type.`);\r\n}\r\n\r\nexport async function fetchMakeupProduct<T extends Record<string, string>>(productKey: string, props?: T): Promise<IMakeupProduct<T>>\r\n{\r\n    if(typeof productKey !== 'string')\r\n        throw new RangeError(`Invalid arguments: fetchMakeupProduct(${productKey}: string)`);\r\n\r\n    const workspaceKey = (await configAsync).workspaces.Makeup;\r\n    const product = await fetchProduct(workspaceKey, productKey, props);\r\n    if(product.isMakeup()) return product;\r\n    else throw new Error(`${productKey} is not of 'Makeup' type.`);\r\n}","import { I3DProduct } from '../../api';\r\nimport { editor as Data } from '../../data';\r\nimport { _Widget } from '../widgets/_Widget';\r\nimport { _Product } from '../products/_Product';\r\nimport { _3DProduct } from '../products/_3DProduct';\r\nimport { _3DWidget } from '../widgets/_3DWidget';\r\nimport * as Messaging from '../widgets/Messaging';\r\n\r\nexport class _EditorWidget<T, P extends I3DProduct<T>> extends _3DWidget<T, _3DProduct<T>>\r\n{\r\n    public _editor = true;\r\n\r\n    constructor(\r\n        defaultVariation: P,\r\n        domElement: HTMLDivElement\r\n    ){\r\n        super(defaultVariation as any, domElement, `${Data.apps.viewer}?workspaceId=${defaultVariation.workspaceKey}&referenceId=${defaultVariation.productKey}`);\r\n    }\r\n\r\n    public async debug()\r\n    {\r\n        const query = await this.QueryAsync({\r\n            event: Messaging.WidgetEvent.Debug,\r\n            value: null\r\n        });\r\n        return Boolean(query.value);\r\n    }\r\n\r\n    public async save()\r\n    {\r\n        const query = await this.QueryAsync({\r\n            event: Messaging.WidgetEvent.Save,\r\n            value: null\r\n        });\r\n        return Boolean(query.value);\r\n    }\r\n}\r\n","import { I3DProduct } from '../../api';\r\nimport { _Widget } from '../widgets/_Widget';\r\nimport { _EditorWidget } from './_EditorWidget';\r\nimport { _3DProduct } from '../products/_3DProduct';\r\n\r\n\r\nexport namespace Internal\r\n{\r\n    export const EditorWidget = _EditorWidget;\r\n\r\n    export async function createEditorWidget<T extends Record<string, string>>(defaultVariation: I3DProduct<T>, domElement: HTMLDivElement)\r\n    {\r\n        const widget = new EditorWidget<T, I3DProduct<T>>(defaultVariation as any, domElement);\r\n        return await widget.waitForInit;\r\n    }\r\n}","console.log('@designhubz-widget/lib');\r\n\r\nimport './_Data';\r\nexport * from './_API';\r\nexport * from './internal';\r\n"],"names":["searchParams","Messaging.DESIGNHUBZ_API_TYPE","Data"],"mappings":"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"}