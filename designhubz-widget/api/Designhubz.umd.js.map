{"version":3,"file":"Designhubz.umd.js","sources":["../src/packages/data/Data.ts","../src/packages/data/index.ts","../src/packages/data-source/MockData.ts","../src/packages/lib/_Dev.ts","../src/packages/lib/_Data.ts","../src/packages/lib/products/_Product.ts","../src/packages/utils/Browser.ts","../src/packages/utils/Signals.ts","../src/packages/utils/index.ts","../src/packages/lib/widgets/Snapshot.ts","../src/packages/lib/widgets/Messaging.ts","../src/packages/lib/widgets/_Widget.ts","../src/packages/lib/widgets/_3DWidget.ts","../src/packages/lib/products/_3DProduct.ts","../src/packages/lib/widgets/_EyewearWidget.ts","../src/packages/lib/products/_EyewearProduct.ts","../src/packages/lib/products/Factory.ts","../src/packages/lib/_Config.ts","../src/packages/lib/_API.ts","../src/packages/lib/internal/_EditorWidget.ts","../src/packages/lib/internal/index.ts","../src/packages/lib/index.ts"],"sourcesContent":["import { IProduct, IDigitization, IClientConfig, Input } from './Storage';\r\nimport { IScene, ISkin } from './Internal';\r\n\r\nclass CustomError\r\n{\r\n\tpublic name?: string;\r\n\tpublic stack?: string;\r\n\tpublic message?: string;\r\n\r\n\tconstructor(error?: string | Error) \r\n\t{\r\n\t\tlet errorObject: Error;\r\n\t\tif(error === undefined || typeof error === 'string') errorObject = new Error(error);\r\n\t\telse errorObject = error;\r\n\t\tObject.assign(this, errorObject);\r\n\t}\r\n}\r\n\r\nexport namespace Errors\r\n{\r\n    export class NotFoundError extends CustomError\r\n    {\r\n        constructor()\r\n        {\r\n            super('NotFoundError');\r\n        }\r\n    }\r\n\r\n    export class AuthenticationError extends CustomError\r\n    {\r\n        constructor()\r\n        {\r\n            super('AuthenticationError');\r\n        }\r\n    }\r\n\r\n    export type ProductData = NotFoundError | AuthenticationError;\r\n    export type Session = NotFoundError | AuthenticationError;\r\n    export type Scene = NotFoundError | AuthenticationError;\r\n    export type Skin = NotFoundError | AuthenticationError;\r\n    export type DigitizationData = NotFoundError;\r\n}\r\n\r\nexport interface IWidgetData\r\n{\r\n    FetchClientConfig(): Promise<IClientConfig>;\r\n    FetchProduct(workspaceId: string, referenceId: string, collectVariationDetails: boolean): Promise<IProduct>;\r\n    \r\n    /** @returns sessionId */\r\n    CreateSession(workspaceId: string, referenceId: string, userId: string): Promise<string>;\r\n    UpdateSession(sessionId: string, data: Input.ISessionData): Promise<void>;\r\n}\r\n\r\nexport interface IViewerData extends IWidgetData\r\n{\r\n    FetchScene(workspaceId: string, referenceId: string): Promise<IScene>;\r\n    \r\n    FetchSkin(workspaceId: string): Promise<ISkin>;\r\n}\r\n\r\nexport interface IEditorData extends IViewerData\r\n{\r\n    readonly apps: {\r\n        viewer: string;\r\n        editor: string;\r\n        eyewear: string;\r\n    };\r\n\r\n    CreateScene(workspaceId: string, referenceId: string, name: string, sceneData?: Input.TJSON, files?: Input.IUploadAsset[]): Promise<IScene>;\r\n    UpdateScene(workspaceId: string, referenceId: string, update: {\r\n        name?: string, // Not implemented server side\r\n        sceneData?: Input.TJSON\r\n    }): Promise<IScene>;\r\n    DeleteScene(workspaceId: string, referenceId: string): Promise<void>;\r\n\r\n    UploadSceneAssets(workspaceId: string, referenceId: string, files: Input.IUploadAsset[]): Promise<IScene>;\r\n    DeleteSceneAssets(workspaceId: string, referenceId: string, names: string[]): Promise<IScene>;\r\n\r\n    CreateSkin(workspaceId: string, skinData: Input.TJSON, files: Input.IUploadAsset[]): Promise<ISkin>;\r\n    DeleteSkin(workspaceId: string): Promise<void>;\r\n\r\n    FetchDigitization(workspaceId: string, modelCode: string): Promise<IDigitization>;\r\n}\r\n","import { IWidgetData, IViewerData, IEditorData } from './Data';\r\nexport * from './Data';\r\nimport * as _Storage from './Storage';\r\nexport import Storage = _Storage;\r\n\r\nimport * as _Internal from './Internal';\r\nexport import Internal = _Internal;\r\n\r\nexport let widget: IWidgetData;\r\nexport let viewer: IViewerData;\r\nexport let editor: IEditorData;\r\n\r\nexport function SetWidgetSource(value: IWidgetData)\r\n{\r\n    widget = value;\r\n}\r\nexport function SetViewerSource(value: IViewerData)\r\n{\r\n    viewer = value;\r\n    SetWidgetSource(value);\r\n}\r\nexport function SetEditorSource(value: IEditorData)\r\n{\r\n    editor = value;\r\n    SetViewerSource(value);\r\n}\r\n","import { IWidgetData, IViewerData, IEditorData, Storage, Errors } from '../data';\r\n\r\nconst searchParams = (new URL(window.location.href)).searchParams;\r\nconst local = Boolean(searchParams.get('local'));\r\nconst s3 = 'https://designhubz-viewer-data.s3-eu-west-1.amazonaws.com/';\r\nconst rootUrl = local ? './storage.ignore/' : s3;\r\n\r\nconst localFlag = local ? '?local=1' : '';\r\nconst apps = {\r\n    viewer: (local ? local + ':2020/example/viewer.html' : 'https://dg0iszzfyf3bz.cloudfront.net/') + localFlag,\r\n    editor: (local ? local + ':2020/example/editor.html' : s3 + 'apps/viewer/editor.html') + localFlag,\r\n    eyewear: (local ? local + ':3000/' : s3 + 'apps/eyewear/index.html') + localFlag\r\n};\r\n\r\nconst blobToBuffer = (blob: Blob) => new Response(blob).arrayBuffer();\r\n\r\nconst fetchJSON = async (url: string) => {\r\n    const response = await fetch(url, { method: 'GET' });\r\n    return response.ok ? response.json() : undefined;\r\n};\r\n// #endregion\r\n\r\n// https://designhubz-viewer-data.s3-eu-west-1.amazonaws.com/user/workspace/eyewear/glass1/scene.json\r\nconst folder = {\r\n    w: (workspaceKey: string) => `${rootUrl}user/workspace/${workspaceKey}/`,\r\n    s: (workspaceKey: string, productKey: string) => `${folder.w(workspaceKey)}scene/${productKey}/`,\r\n    f: (publicFolderUrl: string) => publicFolderUrl.slice(rootUrl.length),\r\n    p: (workspaceKey: string) => `${rootUrl}user/workspace/${workspaceKey}/productData/`,\r\n    d: (workspaceKey: string) => `${rootUrl}user/workspace/${workspaceKey}/digitization/`,\r\n    a: () => `${rootUrl}user/sessions/`\r\n};\r\n\r\n// #region mock server interface (./publish/example/remote/server.js)\r\nconst serverUrl = 'http://127.0.0.1:8082/';\r\nasync function deleteAsync(path: string): Promise<void>\r\n{\r\n    let url = `${serverUrl}?path=${escape(path)}`;\r\n    await fetch(url, { method: 'DELETE' });\r\n}\r\n\r\nasync function storeAsync(path: string, asset: ArrayBuffer | string): Promise<void>\r\n{\r\n    let url = `${serverUrl}?path=${escape(path)}`;\r\n    await fetch(url, {\r\n        method: 'POST', \r\n        body: asset\r\n    });\r\n}\r\n// #endregion\r\n\r\nclass WidgetData implements IWidgetData\r\n{\r\n    async FetchClientConfig(): Promise<Storage.IClientConfig>\r\n    {\r\n        return {\r\n            workspaces: {\r\n                '3D': 'eyewear',\r\n                'Eyewear': 'eyewear',\r\n                'Makeup': 'makeup'\r\n            }\r\n        };\r\n    }\r\n\r\n    async FetchProduct(workspaceId: string, referenceId: string, collectVariationDetails = true): Promise<Storage.IProduct>\r\n    {\r\n        const path = folder.p(workspaceId);\r\n        const product: Storage.IProduct = await fetchJSON(path + referenceId + '.json');\r\n        if(product === undefined) throw new Errors.NotFoundError();\r\n        return product;\r\n    }\r\n\r\n    async FetchSession(sessionId: string): Promise<Storage.Input.ISessionData>\r\n    {\r\n        const path = folder.a();\r\n        const session: Storage.Input.ISessionData = await fetchJSON(path + sessionId + '.json');\r\n        if(session === undefined) throw new Errors.NotFoundError();\r\n        return session;\r\n    }\r\n    async CreateSession(workspaceId: string, referenceId: string, userId: string): Promise<string>\r\n    {\r\n        const sessionId = `${workspaceId}-${referenceId}-${userId}-${Date.now()}`;\r\n        return sessionId;\r\n    }\r\n    async UpdateSession(sessionId: string, data: Storage.Input.ISessionData): Promise<void>\r\n    {\r\n        const path = folder.a();\r\n        await storeAsync(path + sessionId + '.json', JSON.stringify(data));\r\n    }\r\n}\r\n\r\ninterface IMockScene extends Omit<Storage.IScene, 'publicFolderUrl'>\r\n{\r\n    _assetsUrls: Storage.IAssetUrl[];\r\n}\r\n\r\ninterface IMockSkin extends Omit<Storage.ISkin, 'publicFolderUrl'>\r\n{\r\n    _assetsUrls: Storage.IAssetUrl[];\r\n}\r\n\r\nconst resolveUrls = (publicFolderUrl: string, assetsUrls: Storage.IAssetUrl[]) => { \r\n    assetsUrls.forEach( v => (v as any).url = `${rootUrl}${publicFolderUrl}${v.name}` );\r\n};\r\n\r\nclass ViewerData extends WidgetData implements IViewerData\r\n{\r\n    async FetchScene(workspaceId: string, referenceId: string): Promise<Storage.IScene>\r\n    {\r\n        const path = folder.s(workspaceId, referenceId);\r\n        const scene: IMockScene = await fetchJSON(path + 'scene.json');\r\n        if(scene === undefined) throw new Errors.NotFoundError();\r\n        scene._assetsUrls = JSON.parse(JSON.stringify(scene.assetsUrls));\r\n        const publicFolderUrl = folder.f(path);\r\n        resolveUrls(publicFolderUrl, scene.assetsUrls);\r\n        return Object.assign({\r\n            publicFolderUrl: publicFolderUrl\r\n        }, scene);\r\n    }\r\n    async FetchSkin(workspaceId: string): Promise<Storage.ISkin>\r\n    {\r\n        const path = folder.w(workspaceId);\r\n        const skin: IMockSkin = await fetchJSON(path + 'skin.json');\r\n        if(skin === undefined) throw new Errors.NotFoundError();\r\n        skin._assetsUrls = JSON.parse(JSON.stringify(skin.assetsUrls));\r\n        const publicFolderUrl = folder.f(path);\r\n        resolveUrls(publicFolderUrl, skin.assetsUrls);\r\n        return Object.assign({\r\n            publicFolderUrl: publicFolderUrl\r\n        }, skin);\r\n    }\r\n}\r\n\r\nexport class MockData extends ViewerData implements IEditorData\r\n{\r\n    public readonly apps = apps;\r\n\r\n    async CreateScene(workspaceId: string, referenceId: string, name: string, sceneData?: Storage.Input.TJSON, files?: Storage.Input.IUploadAsset[]): Promise<Storage.IScene>\r\n    {\r\n        const path = folder.s(workspaceId, referenceId);\r\n\r\n        const assetsUrls: {name: string, url: string}[] = [];\r\n        if(files !== undefined) await Promise.all( files.map( async file => {\r\n            assetsUrls.push({\r\n                name: file.name,\r\n                url: file.name\r\n            });\r\n            return storeAsync(path + file.name, await blobToBuffer(file.content));\r\n        }));\r\n        \r\n        const scene: IMockScene = {\r\n            _assetsUrls: assetsUrls,\r\n            assetsUrls: assetsUrls,\r\n            createdAt: Date.now(),\r\n            isActive: false,\r\n            name: name,\r\n            sceneData: sceneData,\r\n            referenceId: referenceId,\r\n            workspaceId: workspaceId\r\n        };\r\n        await storeAsync(path + 'scene.json', JSON.stringify(scene));\r\n\r\n        return this.FetchScene(workspaceId, referenceId);\r\n    }\r\n    async UpdateScene(workspaceId: string, referenceId: string, update: {\r\n        name?: string;\r\n        sceneData?: Storage.Input.TJSON;\r\n        files?: Storage.Input.IUploadAsset[],\r\n        deleteFiles?: string[]\r\n    }): Promise<Storage.IScene>\r\n    {\r\n        let scene = await this.FetchScene(workspaceId, referenceId);\r\n        if(update.name !== undefined) (scene as any).name = update.name;\r\n        if(update.sceneData !== undefined) (scene as any).sceneData = update.sceneData;\r\n\r\n        const assetsUrls: IMockScene['_assetsUrls'] = (scene as any)._assetsUrls;\r\n        if(update.files !== undefined)\r\n        {\r\n            await Promise.all( update.files.map( async file => {\r\n                assetsUrls.push({\r\n                    name: file.name,\r\n                    url: file.name\r\n                });\r\n                return storeAsync(path + file.name, await blobToBuffer(file.content));\r\n            }));\r\n        }\r\n        if(update.deleteFiles !== undefined)\r\n        {\r\n            await Promise.all( update.deleteFiles.map( filename => {\r\n                const i = assetsUrls.findIndex( v => v.name === filename );\r\n                if(i !== -1) assetsUrls.splice(i, 1);\r\n                return deleteAsync(path + filename);\r\n            }));\r\n        }\r\n        (scene as any).assetsUrls = assetsUrls;\r\n\r\n        const path = folder.s(workspaceId, referenceId);\r\n        await storeAsync(path + 'scene.json', JSON.stringify(scene));\r\n\r\n        return this.FetchScene(workspaceId, referenceId);\r\n    }\r\n    async DeleteScene(workspaceId: string, referenceId: string): Promise<void>\r\n    {\r\n        const scene = await this.FetchScene(workspaceId, referenceId);\r\n        const path = folder.s(workspaceId, referenceId);\r\n        await deleteAsync(path + 'scene.json');\r\n    }\r\n\r\n    async UploadSceneAssets(workspaceId: string, referenceId: string, files: Storage.Input.IUploadAsset[]): Promise<Storage.IScene>\r\n    {\r\n        return this.UpdateScene(workspaceId, referenceId, {files: files});\r\n    }\r\n    async DeleteSceneAssets(workspaceId: string, referenceId: string, names: string[]): Promise<Storage.IScene>\r\n    {\r\n        return this.UpdateScene(workspaceId, referenceId, {deleteFiles: names});\r\n    }\r\n\r\n    async CreateSkin(workspaceId: string, skinData: Storage.Input.TJSON, files: Storage.Input.IUploadAsset[]): Promise<Storage.ISkin>\r\n    {\r\n        const path = folder.w(workspaceId);\r\n\r\n        const assetsUrls: {name: string, url: string}[] = [];\r\n        if(files !== undefined) await Promise.all( files.map( async file => {\r\n            assetsUrls.push({\r\n                name: file.name,\r\n                url: file.name\r\n            });\r\n            return storeAsync(path + file.name, await blobToBuffer(file.content));\r\n        }));\r\n        \r\n        const skin: IMockSkin = {\r\n            _assetsUrls: assetsUrls,\r\n            assetsUrls: assetsUrls,\r\n            createdAt: Date.now(),\r\n            isActive: false,\r\n            skinData: skinData,\r\n            workspaceId: workspaceId\r\n        };\r\n        await storeAsync(path + 'skin.json', JSON.stringify(skin));\r\n\r\n        return this.FetchSkin(workspaceId);\r\n    }\r\n    async DeleteSkin(workspaceId: string): Promise<void>\r\n    {\r\n        const skin = await this.FetchSkin(workspaceId);\r\n        const path = folder.w(workspaceId);\r\n        await deleteAsync(path + 'skin.json');\r\n    }\r\n\r\n    async FetchDigitization(workspaceId: string, modelCode: string): Promise<Storage.IDigitization>\r\n    {\r\n        const path = folder.d(workspaceId);\r\n        const digitization: Storage.IDigitization = await fetchJSON(path + modelCode + '.json');\r\n        if(digitization === undefined) throw new Errors.NotFoundError();\r\n        return digitization;\r\n    }\r\n}\r\n","import { Dev } from '../api';\r\n\r\nconst formatOptions = ['font-weight', 'color', 'background'];\r\n\r\nexport const _dev = new (\r\n    class _Dev implements Dev\r\n    {\r\n        public debug = false;\r\n\r\n        public Log(...args: Array<any>)\r\n        {\r\n            if(this.debug)\r\n            {\r\n                const formatting: string[] = [];\r\n                for(let i = 0; i < args.length - 1; i++)\r\n                {\r\n                    const arg = args[i];\r\n                    const text = args[i + 1];\r\n                    if(typeof arg === 'string' && typeof text === 'string' && arg.slice(0, 2) === '#(')\r\n                    {\r\n                        const optionsArgs = arg.slice(2, arg.length - 1).split(',');\r\n                        let format = formatOptions.map( (o, i) => \r\n                            typeof optionsArgs[i] === 'string' && optionsArgs[i].length > 0\r\n                                ? `${o}:${optionsArgs[i]};`\r\n                            : ''\r\n                        ).join(' ');\r\n                        \r\n                        args.splice(i, 1);\r\n                        args[i] = `%c ${text} `;\r\n                        formatting.push(format);\r\n                    }\r\n                }\r\n                if(formatting.length > 0) console.log(args.map( arg => arg.toString() ).join(''), ...formatting);\r\n                else console.log(...args);\r\n            }\r\n        }\r\n\r\n        public CreateError(name: string, message?: string)\r\n        {\r\n            this.Log(`Created ERROR '${name}': '${message}'`);\r\n            const error = new Error(message);\r\n            error.name = name;\r\n            return error;\r\n        }\r\n    }\r\n);\r\n","\r\nimport { SetEditorSource } from '../data';\r\nimport { MockData } from '../data-source';\r\nimport { _dev } from './_Dev';\r\n\r\nif(!window.location) throw new Error('Expected access to window.location');\r\nif(!('href' in window.location)) throw new Error('Expected href in window.location');\r\n\r\nSetEditorSource(new MockData());\r\n\r\n/** enabled = ?designhubz_debug=bool */\r\nexport const DEV_DEBUG_URL_PARAM = 'designhubz_debug';\r\nconst bool = (p: string | null) => p === '1' || p === 'true';\r\nconst searchParams = (new URL(window.location.href)).searchParams;\r\nif(bool(searchParams.get(DEV_DEBUG_URL_PARAM))) _dev.debug = true;\r\n","import { IProduct, IScoredRecommendation } from '../../api';\r\n\r\nexport abstract class _Product<T> implements IProduct<T>\r\n{\r\n    public readonly is3D = () => false;\r\n    public readonly isEyewear = () => false;\r\n    public readonly isMakeup = () => false;\r\n\r\n    public readonly variations: this[];\r\n\r\n    constructor(\r\n        public readonly workspaceKey: string,\r\n        public readonly productKey: string,\r\n        public readonly properties: T,\r\n        variations: _Product<T>[]\r\n    )\r\n    {\r\n        this.variations = variations as this[];\r\n    }\r\n\r\n    public get thumbnailURL(){ return ''; }\r\n\r\n    public fetchRecommendations(num: number, external?: IScoredRecommendation[]): Promise<IScoredRecommendation[]>\r\n    {\r\n        const recommendations = new Array<IScoredRecommendation>(num);\r\n        recommendations.map( (_, i) => { \r\n            return {\r\n                sku: i.toString(),\r\n                score: i / num\r\n            };\r\n        });\r\n        return new Promise( r => r(recommendations) );\r\n    }\r\n}\r\n","\r\nexport namespace Dom\r\n{\r\n    export function CreateStylesheet(css: string)\r\n    {\r\n        const style = document.createElement('style');\r\n        style.type = 'text/css';\r\n        style.innerHTML = css;\r\n        document.getElementsByTagName('head')[0].appendChild(style);\r\n        return style;\r\n    }\r\n\r\n    export function BuildHTML<T extends HTMLElement>(html: string): T\r\n    {\r\n        const div = document.createElement('div');\r\n        div.innerHTML = html.trim();\r\n        return div.firstChild as T;\r\n    }\r\n}\r\n","type callback<T> = (arg: T) => void;\r\n\r\nexport interface ISignal<T>\r\n{\r\n    Add(callback: callback<T>): void;\r\n    Remove(callback: callback<T>): void;\r\n    Once(callback: callback<T>): void;\r\n}\r\n\r\nexport class Signal<T> implements ISignal<T>\r\n{\r\n    public callbacks: callback<T>[];\r\n\r\n    constructor()\r\n    {\r\n        this.callbacks = [];\r\n    }\r\n\r\n    public Add(callback: callback<T>)\r\n    {\r\n        if(typeof callback !== 'function')\r\n        {\r\n            console.warn('Not a function', callback);\r\n            throw(\"'callback' should be a function.\");\r\n        }\r\n        this.callbacks.push(callback);\r\n    }\r\n\r\n    public Remove(callback: callback<T>)\r\n    {\r\n        const index = this.callbacks.indexOf(callback);\r\n        if(index !== -1) this.callbacks.splice(index, 1);\r\n    }\r\n\r\n    public Dispatch(arg: T)\r\n    {\r\n        for(let i = 0; i < this.callbacks.length; i++) this.callbacks[i](arg);\r\n    }\r\n\r\n    public Once(callback: callback<T>)\r\n    {\r\n        const once = (arg: T) => {\r\n            this.Remove(once);\r\n            callback(arg);\r\n        };\r\n        this.Add(once);\r\n    }\r\n}\r\n\r\n// Example\r\nclass Keyboard\r\n{\r\n    private readonly _onInput = new Signal<string>();\r\n    public get Input(): ISignal<string> { return this._onInput; }\r\n\r\n    public Enter(text: string)\r\n    {\r\n        this._onInput.Dispatch(text);\r\n    }\r\n\r\n    public static Example()\r\n    {\r\n        const keyboard = new Keyboard();\r\n        keyboard.Input.Add(key => console.log(`keyboard.Input -> ${key}`));\r\n        keyboard.Enter('x');\r\n    }\r\n}\r\n","console.log('@designhubz-widget/utils');\r\n\r\nexport * from './Browser';\r\nexport * from './Signals';","import { ISnapshot } from '../../api';\r\n\r\ntype TImageSource = (CanvasImageSource & {width: number, height: number}) | ImageData;\r\nlet _canvas: HTMLCanvasElement;\r\n\r\nfunction DrawToCanvas(source: TImageSource, flip: boolean)\r\n{\r\n    if(_canvas === undefined) _canvas = document.createElement('canvas');\r\n\r\n\t_canvas.width = source.width;\r\n\t_canvas.height = source.height;\r\n\r\n    const context = _canvas.getContext('2d')!;\r\n    context.resetTransform();\r\n    if(flip)\r\n    {\r\n        context.translate(0, _canvas.height);\r\n        context.scale(1, -1);\r\n    }\r\n\r\n    if(source instanceof ImageData) context.putImageData(source, 0, 0);\r\n    else context.drawImage(source, 0, 0, source.width, source.height);\r\n    return _canvas;\r\n}\r\n\r\nexport class Snapshot implements ISnapshot\r\n{\r\n    constructor(public readonly imageData: ImageData)\r\n    {}\r\n\r\n    public getDataURL(type: 'jpeg' | 'png', quality?: number)\r\n    {\r\n        const canvas =  DrawToCanvas(this.imageData, false);\r\n        return canvas.toDataURL(type === 'jpeg' ? 'image/jpeg' : 'image/png', quality)\r\n    }\r\n\r\n    public async getBlobAsync(type: 'jpeg' | 'png', quality?: number)\r\n    {\r\n        const canvas =  DrawToCanvas(this.imageData, false);\r\n        const blob = await new Promise<Blob>( (resolve, reject) => \r\n            canvas.toBlob( blob => {\r\n                if(blob === null) reject('Failed to generate Blob');\r\n                else resolve(blob);\r\n            }, type === 'jpeg' ? 'image/jpeg' : 'image/png', quality)\r\n        );\r\n\r\n        return blob;\r\n    }\r\n}\r\n","\r\nexport const DESIGNHUBZ_API_TYPE = 'designhubz-api';\r\n\r\nexport const enum WidgetEvent {\r\n    Init = 'Init',\r\n    SnapshotRequest = 'SnapshotRequest',\r\n    Save = 'Save',\r\n    Debug = 'Debug'\r\n}\r\n\r\nexport interface IWidgetMessageData\r\n{\r\n    type: string;\r\n    id: string;\r\n    event: WidgetEvent;\r\n    value: any;\r\n}\r\n\r\nexport type TWidgetMessage = { data: IWidgetMessageData };\r\n","import { IWidget, IProduct, Stat, TProgressCallback } from '../../api';\r\nimport { Signal, Dom, ISignal } from '../../utils';\r\nimport { _dev } from '../_Dev';\r\nimport { _Product } from '../products/_Product';\r\nimport { Snapshot } from './Snapshot';\r\nimport * as Messaging from './Messaging';\r\n\r\nexport abstract class _Widget<T, P extends IProduct<T>> implements IWidget<T, P>\r\n{\r\n    public readonly waitForInit = new Promise<this>( resolve => (this as any)._waitForInit = resolve );\r\n\r\n    protected _variation: P;\r\n    protected _iframe: HTMLIFrameElement;\r\n\r\n    private readonly _id = Math.floor(Math.random() * 1000) + '-';\r\n    private _queriesCount = 0;\r\n    private _pending = new Map<string, (arg: any) => void>();\r\n\r\n    constructor(\r\n        defaultVariation: P,\r\n        public readonly domElement: HTMLDivElement\r\n    ){\r\n        onmessage = message => {\r\n            if(message.data?.type === Messaging.DESIGNHUBZ_API_TYPE )\r\n                this.OnWidgetMessage((message as Messaging.TWidgetMessage).data);\r\n        };\r\n\r\n        this._variation = defaultVariation;\r\n\r\n        this._iframe = Dom.BuildHTML<HTMLIFrameElement>(`<iframe\r\n    style=\"width: 1px; min-width: 100%; *width: 100%; height: 1px; min-height: 100%; *height: 100%;\" \r\n    width=\"100%\" height=\"100%\" scrolling=\"no\" frameBorder=\"0\"\r\n</iframe>`);\r\n    }\r\n\r\n    public get variation(){ return this._variation; }\r\n\r\n    public async loadVariation(variation: P, progressHandler?: TProgressCallback)\r\n    {\r\n        if(this._variation.variations.every( v => v.productKey !== variation.productKey ))\r\n            throw new Error(`Product '${variation.productKey}' is not a variation of ${this._variation.variations.map( v => v.productKey ).join(', ')}`);\r\n\r\n        if(progressHandler !== undefined)\r\n        {\r\n            \r\n        }\r\n    }\r\n\r\n    public async takeSnapshotAsync()\r\n    {\r\n        const query = await this.QueryAsync({\r\n            event: Messaging.WidgetEvent.SnapshotRequest,\r\n            value: {\r\n                flip: false\r\n            }\r\n        });\r\n        const imageData = new ImageData(new Uint8ClampedArray(query.value.data.buffer), query.value.width, query.value.height)\r\n        return new Snapshot(imageData);\r\n    }\r\n\r\n    public sendStat(stat: Stat)\r\n    {\r\n        return Promise.resolve();\r\n    }\r\n\r\n    public async disposeAsync()\r\n    {\r\n        if(this._iframe.parentElement !== null) this._iframe.parentElement.removeChild(this._iframe);\r\n    }\r\n\r\n    protected OnWidgetMessage(data: Messaging.IWidgetMessageData)\r\n    {\r\n        let resolver = this._pending.get(data.id);\r\n        if(resolver !== undefined)\r\n        {\r\n            resolver(data);\r\n        }\r\n        else\r\n        {\r\n            switch(data.event)\r\n            {\r\n                case Messaging.WidgetEvent.Init:\r\n                    (this as any)._waitForInit(this);\r\n                break;\r\n\r\n                default:\r\n                    _dev.Log(`No listeners on '${event}'`, data.value);\r\n                break;\r\n            } \r\n        }\r\n    }\r\n\r\n    protected async QueryAsync(message: Messaging.IWidgetMessageData, waitForReply?: boolean): Promise<Messaging.IWidgetMessageData>\r\n    protected async QueryAsync(message: Omit<Messaging.IWidgetMessageData, 'type' | 'id'>, waitForReply?: boolean): Promise<Messaging.IWidgetMessageData>\r\n    protected async QueryAsync(message: Messaging.IWidgetMessageData, waitForReply = true): Promise<Messaging.IWidgetMessageData>\r\n    {\r\n        if(this._iframe.contentWindow === null) throw new Error(`Can't query iframe's contentWindow.`);\r\n\r\n        if(('type' in message && 'id' in message) === false)\r\n        {\r\n            message = Object.assign({\r\n                type: Messaging.DESIGNHUBZ_API_TYPE,\r\n                id: this._id + (this._queriesCount++)\r\n            }, message);\r\n        }\r\n\r\n        const promise = waitForReply\r\n            ? new Promise<Messaging.IWidgetMessageData>( r => this._pending.set(message.id, r) )\r\n        : Promise.resolve(message);\r\n\r\n        this._iframe.contentWindow!.postMessage(message, '*');\r\n        return promise;\r\n    }\r\n\r\n    protected Attach()\r\n    {\r\n        // what kind of dom events do I need to handle?\r\n        this.domElement.appendChild(this._iframe);\r\n    }\r\n}","import { I3DWidget } from '../../api';\r\nimport { editor as Data } from '../../data';\r\nimport { _Widget } from './_Widget';\r\nimport { _Product } from '../products/_Product';\r\nimport { _3DProduct } from '../products/_3DProduct';\r\n\r\n\r\nexport class _3DWidget<T, P extends _3DProduct<T>> extends _Widget<T, P> implements I3DWidget<T>\r\n{\r\n    public _3D = true;\r\n\r\n    constructor(\r\n        defaultVariation: P,\r\n        domElement: HTMLDivElement,\r\n        src?: string\r\n    ){\r\n        super(defaultVariation, domElement);\r\n\r\n        this._iframe.src = src ?? `${Data.apps.viewer}?workspaceId=${defaultVariation.workspaceKey}&referenceId=${defaultVariation.productKey}`;\r\n        this.Attach();\r\n    }\r\n}","import { I3DProduct, TProgressCallback } from '../../api';\r\nimport { _Product } from './_Product';\r\nimport { _3DWidget } from '../widgets/_3DWidget';\r\n\r\nexport class _3DProduct<T> extends _Product<T> implements I3DProduct<T>\r\n{\r\n    public _3D = true;\r\n    public readonly is3D = () => true;\r\n    \r\n    public async create3DWidget(domElement: HTMLDivElement, progressHandler?: TProgressCallback): Promise<_3DWidget<T, this>>\r\n    {\r\n        const widget = new _3DWidget(this, domElement);\r\n        return await widget.waitForInit;\r\n    }\r\n}\r\n","import { IEyewearWidget, TrackingStatus } from '../../api';\r\nimport { ISignal, Signal } from '../../utils';\r\nimport { editor as Data } from '../../data';\r\nimport { _Widget } from './_Widget';\r\nimport { _EyewearProduct } from '../products/_EyewearProduct';\r\n\r\nexport class _EyewearWidget<T, P extends _EyewearProduct<T>> extends _Widget<T, P> implements IEyewearWidget<T>\r\n{\r\n    public _eyewear = true;\r\n    \r\n    public readonly onTrackingStatusChange: ISignal<TrackingStatus> = new Signal();\r\n    \r\n    constructor(\r\n        defaultVariation: P,\r\n        domElement: HTMLDivElement\r\n    ){\r\n        super(defaultVariation, domElement);\r\n\r\n        this._iframe.setAttribute('allow', 'camera;microphone');\r\n        this._iframe.src = `${Data.apps.viewer}?workspaceId=${defaultVariation.workspaceKey}&referenceId=${defaultVariation.productKey}`;\r\n        console.log(this._iframe.src);\r\n        this.Attach();\r\n    }\r\n\r\n    public get fit(){ return true; }\r\n}","import { IEyewearProduct, TProgressCallback } from '../../api';\r\nimport { _3DProduct } from './_3DProduct';\r\nimport { _3DWidget } from '../widgets/_3DWidget';\r\nimport { _EyewearWidget } from '../widgets/_EyewearWidget';\r\n\r\nexport class _EyewearProduct<T> extends _3DProduct<T> implements IEyewearProduct<T>\r\n{\r\n    public _eyewear = true;\r\n    public _3D = true;\r\n    public readonly isEyewear = () => true;\r\n    \r\n    public async create3DWidget(domElement: HTMLDivElement, progressHandler?: TProgressCallback): Promise<_3DWidget<T, this>>\r\n    {\r\n        const widget = new _3DWidget(this, domElement);\r\n        return await widget.waitForInit;\r\n    }\r\n\r\n    public async createEyewearWidget(domElement: HTMLDivElement, progressHandler?: TProgressCallback): Promise<_EyewearWidget<T, this>>\r\n    {\r\n        const widget = new _EyewearWidget(this, domElement);\r\n        return await widget.waitForInit;\r\n    }\r\n\r\n    public async createMultiWidget(domElement: HTMLDivElement, progressHandler?: TProgressCallback): Promise<any>\r\n    {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n}\r\n","import { Internal } from '../../data';\r\nimport { _Product } from './_Product';\r\nimport { _3DProduct } from './_3DProduct';\r\nimport { _EyewearProduct } from './_EyewearProduct';\r\n\r\nconst _productsCache: Record<string, _Product<any>> = {};\r\nexport function ProductFromCache<T>(workspaceKey: string, productKey: string): _Product<T> | undefined\r\n{\r\n    return _productsCache[workspaceKey + productKey];\r\n}\r\n\r\nconst _variationsCache: Record<string, _Product<any>[]> = {};\r\nfunction VariationsFromCache<T>(workspaceKey: string, productKey: string): _Product<T>[] | undefined\r\n{\r\n    return _variationsCache[workspaceKey + productKey];\r\n}\r\n\r\nexport function ProductFromData<T extends Record<string, string>>(data: Internal.IProductData, props?: T)\r\n{\r\n    let product = ProductFromCache<T>(data.workspaceKey, data.productKey);\r\n    if(product !== undefined) return product;\r\n\r\n    let variations = VariationsFromCache<T>(data.workspaceKey, data.productKey);\r\n    if(variations === undefined)\r\n    {\r\n        variations = [];\r\n        data.variations.forEach( variation => {\r\n            const vData = variation as Internal.IProductData;\r\n            _variationsCache[vData.workspaceKey + vData.productKey] = variations!;\r\n        });\r\n    }\r\n\r\n    if(props !== undefined)\r\n    {\r\n        let missingProps: string[] = [];\r\n        for(const key in props)\r\n        {\r\n            const header = props[key];\r\n            if(header in data.properties)\r\n            {\r\n                if(key in data.properties) console.warn(`Custom property accessor '${key}' will override existing property.`);\r\n                Object.defineProperty(data.properties, key, {\r\n                    get: () => data.properties[header]\r\n                });\r\n            }\r\n            else\r\n            {\r\n                missingProps.push(header);\r\n            }\r\n        }\r\n\r\n        if(missingProps.length > 0)\r\n        {\r\n            const plr = missingProps.length > 1;\r\n            console.warn(`Custom propert${plr ? 'ies' : 'y'}: '${missingProps.join(`', '`)}' ${plr ? 'are' : 'is'} missing from '${data.productKey}'`);\r\n        }\r\n    }\r\n\r\n    const productArgs: [string, string, T, _Product<T>[]] = [\r\n        data.workspaceKey,\r\n        data.productKey,\r\n        data.properties,\r\n        variations\r\n    ];\r\n\r\n    switch(data.productType)\r\n    {\r\n        case '3D':\r\n            product = new _3DProduct<T>(...productArgs);\r\n        break;\r\n        case 'Eyewear':\r\n            product = new _EyewearProduct<T>(...productArgs);\r\n        break;\r\n        case 'Makeup':\r\n            throw 'Not implemented';\r\n        default:\r\n            throw 'Not implemented';\r\n    }\r\n\r\n    variations.push(product);\r\n    _productsCache[data.workspaceKey + data.productKey] = product;\r\n    return product;\r\n}\r\n","import { Storage } from '../data';\r\n\r\ninterface IConfig\r\n{\r\n    readonly workspaces: Record<Storage.TProductType, string>;\r\n}\r\n\r\nexport const configAsync: Promise<IConfig> = new Promise( (resolve, reject) => {\r\n    resolve({\r\n        workspaces: {\r\n            '3D': 'eyewear',\r\n            'Eyewear': 'eyewear',\r\n            'Makeup': 'makeup'\r\n        }\r\n    });\r\n});","import { IProduct, IEyewearProduct, IMakeupProduct } from '../api';\r\nimport { widget as Data } from '../data';\r\nimport { _Product } from './products/_Product';\r\nimport { ProductFromCache, ProductFromData } from './products/Factory';\r\nimport { _dev } from './_Dev';\r\nimport { configAsync } from './_Config';\r\n\r\nexport {\r\n    Stat, TrackingStatus,\r\n    IProduct, IEyewearProduct, IMakeupProduct,\r\n    IWidget, I3DWidget, IEyewearWidget, IMakeupWidget, IMultiWidget\r\n} from '../api';\r\n\r\nexport const version: string = '0.0.7';\r\n\r\nexport const dev = _dev;\r\n\r\nexport async function fetchProduct<T extends Record<string, string>>(workspaceKey: string, productKey: string, props?: T): Promise<IProduct<T>>\r\n{\r\n    if(typeof workspaceKey !== 'string' || typeof productKey !== 'string')\r\n        throw new RangeError(`Invalid arguments: fetchProduct(${workspaceKey}: string, ${productKey}: string)`);\r\n    let product = ProductFromCache<T>(workspaceKey, productKey);\r\n    if(product === undefined)\r\n    {\r\n        _dev.Log('#(bold,#f00)', 'fetching product:', '#()', `(${workspaceKey}, ${productKey})`);\r\n        const productData = await Data.FetchProduct(workspaceKey, productKey, true);\r\n        product = ProductFromData<T>({\r\n            workspaceKey: workspaceKey,\r\n            productKey: productKey,\r\n            name: productData.name,\r\n            productType: 'Eyewear',\r\n            properties: Object.assign({}, productData.originalProperties),\r\n            variations: productData.variations.map( v => {\r\n                return {\r\n                    productKey: v.referenceId,\r\n                    name: v.name,\r\n                    properties: Object.assign({}, v.originalProperties)\r\n                };\r\n            })\r\n        }, props);\r\n    }\r\n    else\r\n    {\r\n        _dev.Log('#(bold,#f88)', '(cache) fetching product:', '#()', `(${workspaceKey} | ${productKey})`);\r\n    }\r\n    return product;\r\n}\r\n\r\nexport async function fetchProducts<T extends Record<string, string>>(workspaceKey: string, productKeys: string[], props?: T): Promise<Record<string, IProduct<T> | undefined>>\r\n{\r\n    if(typeof workspaceKey !== 'string' || (productKeys instanceof Array) === false || productKeys.length === 0 || typeof productKeys[0] !== 'string')\r\n        throw new RangeError(`Invalid arguments: fetchProducts(${workspaceKey}: string, ${productKeys.join(', ')}: string[])`);\r\n    \r\n    _dev.Log('#(bold,#000)', 'fetching products:', '#()', `(${workspaceKey}, [${productKeys.join(', ')}])`);\r\n    console.warn('fetchProducts: Not implemented');\r\n    return (void 0)!;\r\n    // const result: Record<string, IProduct<T> | undefined> = {};\r\n    // const stats = {cache: 0, fetch: 0, missing: productKeys.length};\r\n    // const productsToFetch: string[] = [];\r\n    // productKeys.forEach( productKey => {\r\n    //     const product = ProductFromCache<T>(workspaceKey, productKey);\r\n    //     if(product === undefined)\r\n    //     {\r\n    //         productsToFetch.push(productKey);\r\n    //     }\r\n    //     else\r\n    //     {\r\n    //         stats.cache++;\r\n    //         stats.missing--;\r\n    //         result[productKey] = product;\r\n    //     }\r\n    // });\r\n    // if(productsToFetch.length > 0)\r\n    // {\r\n    //     const productsMap = await Data.FetchProducts(workspaceKey, productsToFetch, true);\r\n    //     productsToFetch.forEach( productKey => {\r\n    //         const product = productsMap[productKey];\r\n    //         if(product !== undefined)\r\n    //         {\r\n    //             stats.fetch++;\r\n    //             stats.missing--;\r\n    //             result[productKey] = ProductFromData<T>(product.productData, props);\r\n    //         }\r\n    //     });\r\n    // }\r\n    // _dev.Log(\r\n    //     '#(,#f88)', `${stats.cache} from cache`, ' | ', \r\n    //     stats.fetch > 0 ? '#(bold,#f00)' : '#(bold)', `${stats.fetch} fetched`, ' | ', \r\n    //     stats.missing > 0 ? '#(#fff,#f00)' : '#(bold)', `${stats.missing} missing`);\r\n    // return result;\r\n}\r\n\r\nexport async function fetchEyewearProduct<T extends Record<string, string>>(productKey: string, props?: T): Promise<IEyewearProduct<T>>\r\n{\r\n    if(typeof productKey !== 'string')\r\n        throw new RangeError(`Invalid arguments: fetchEyewearProduct(${productKey}: string)`);\r\n    \r\n    const workspaceKey = (await configAsync).workspaces.Eyewear;\r\n    const product = await fetchProduct(workspaceKey, productKey, props);\r\n    if(product.isEyewear()) return product;\r\n    else throw new Error(`${productKey} is not of 'Eyewear' type.`);\r\n}\r\n\r\nexport async function fetchMakeupProduct<T extends Record<string, string>>(productKey: string, props?: T): Promise<IMakeupProduct<T>>\r\n{\r\n    if(typeof productKey !== 'string')\r\n        throw new RangeError(`Invalid arguments: fetchMakeupProduct(${productKey}: string)`);\r\n\r\n    const workspaceKey = (await configAsync).workspaces.Makeup;\r\n    const product = await fetchProduct(workspaceKey, productKey, props);\r\n    if(product.isMakeup()) return product;\r\n    else throw new Error(`${productKey} is not of 'Makeup' type.`);\r\n}","import { I3DProduct } from '../../api';\r\nimport { editor as Data } from '../../data';\r\nimport { _Widget } from '../widgets/_Widget';\r\nimport { _Product } from '../products/_Product';\r\nimport { _3DProduct } from '../products/_3DProduct';\r\nimport { _3DWidget } from '../widgets/_3DWidget';\r\nimport * as Messaging from '../widgets/Messaging';\r\n\r\nexport class _EditorWidget<T, P extends I3DProduct<T>> extends _3DWidget<T, _3DProduct<T>>\r\n{\r\n    public _editor = true;\r\n\r\n    constructor(\r\n        defaultVariation: P,\r\n        domElement: HTMLDivElement\r\n    ){\r\n        super(defaultVariation as any, domElement, `${Data.apps.viewer}?workspaceId=${defaultVariation.workspaceKey}&referenceId=${defaultVariation.productKey}`);\r\n    }\r\n\r\n    public async debug()\r\n    {\r\n        const query = await this.QueryAsync({\r\n            event: Messaging.WidgetEvent.Debug,\r\n            value: null\r\n        });\r\n        return Boolean(query.value);\r\n    }\r\n\r\n    public async save()\r\n    {\r\n        const query = await this.QueryAsync({\r\n            event: Messaging.WidgetEvent.Save,\r\n            value: null\r\n        });\r\n        return Boolean(query.value);\r\n    }\r\n}\r\n","import { I3DProduct } from '../../api';\r\nimport { _Widget } from '../widgets/_Widget';\r\nimport { _EditorWidget } from './_EditorWidget';\r\nimport { _3DProduct } from '../products/_3DProduct';\r\n\r\n\r\nexport namespace Internal\r\n{\r\n    export const EditorWidget = _EditorWidget;\r\n\r\n    export async function createEditorWidget<T extends Record<string, string>>(defaultVariation: I3DProduct<T>, domElement: HTMLDivElement)\r\n    {\r\n        const widget = new EditorWidget<T, I3DProduct<T>>(defaultVariation as any, domElement);\r\n        return await widget.waitForInit;\r\n    }\r\n}","console.log('@designhubz-widget/lib');\r\n\r\nimport './_Data';\r\nexport * from './_API';\r\nexport * from './internal';\r\n"],"names":["searchParams","Messaging.DESIGNHUBZ_API_TYPE","Data","Internal"],"mappings":"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"}